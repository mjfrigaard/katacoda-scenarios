---
title: "Format and shape your data in R with the tidyverse"
output: 
  github_document: 
    toc: true
    toc_depth: 6
---

```{r setup, include=FALSE}
library(hrbrthemes)
library(extrafont)
library(knitr)
library(rmdformats)
library(tidyverse)
library(magrittr)
library(skimr)
library(rlang)
library(gt)
library(visdat)
library(inspectdf)
library(foreign)
library(naniar)
# images folder
if (!file.exists("figs")) {
  dir.create("figs")
}
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  cache = FALSE,
  prompt = FALSE,
  tidy = FALSE,
  fig.width = 10,
  fig.height = 7.5,
  comment = "#>",
  message = FALSE,
  warning = FALSE,
  fig.path = "figs/"
)
knitr::opts_knit$set(
  width = 78
)
base::options(
  tibble.print_max = 25,
  tibble.width = 78,
  scipen = 100000000
)
ggplot2::theme_set(hrbrthemes::theme_ipsum_tw(
  base_size = 10,
  strip_text_size = 11,
  axis_title_size = 13,
  plot_title_size = 17,
  subtitle_size = 13,
  base_family = "Ubuntu",
  strip_text_family = "TitilliumWeb-Regular",
  axis_title_family = "TitilliumWeb-Regular",
  subtitle_family = "TitilliumWeb-Regular",
  plot_title_family = "JosefinSans-Regular"
))
```

# Access the scenario

You can run through this scenario on Katacoda [here](https://www.katacoda.com/mjfrigaard).

## Setup  

This scenario is built using the following commands in the Terminal pane in RStudio. 

```bash
# create a new scenario
? Friendly url:  format-shape-data
? Scenario Title:  Format and shape your data in R with the tidyverse
? Scenario Description:  Quickly wrangle your data with the tidyr and dplyr packages from the tidyverse
? Difficulty Level:  Intermediate
? Estimated time: (Please specify in minutes or hours e.g. 2 hours) 40
? Number of Steps (Not including intro & finish):  12
? Image:  rlang:3.4
? Layout:  2x Terminal Split
```

The following folder was created from these commands. 

```{r format-shape-data, echo=FALSE}
fs::dir_tree("format-shape-data")
```

We can see all `steps`, the `intro`, and `finish` markdown files. There is also an `index.json` file for managing all the steps in the Katacoda environment.

## Markdown syntax (Katacoda)

Katacoda comes with it's own flavor of Markdown, which you can learn more about [here.](https://katacoda.com/scenario-examples/scenarios/markdown-extensions). The main thing to know is that there are `execute` and `copy` extensions, which you can use in the markdown to indicate whether Katacoda should copy or run the code inside the R REPL.


## Learner personas

The learner personas for this scenario are: 

1. Horatio is an executive at a tech company who wants to learn more about 

2. Judy is a product manager at a start-up...

3. Andrew is a graduate student in college...

***

# Intro

The introduction for this scenario is stored in the following file:

```{r intro, echo=FALSE}
fs::dir_tree("format-shape-data", regex = "intro")
```


# step 1 (install and load packages)

The `step1` file starts the scenario off an intro to R packages (the `base::library()` function). The markdown for the `step1.md` file is below. 

```{r step1, echo=FALSE}
fs::dir_tree("format-shape-data", regex = "step1.md")
```

# step 2 (tribble)


```{r step2, echo=FALSE}
fs::dir_tree("format-shape-data", regex = "step2.md")
```


This step loads the data into R (using the `tibble` package). 

```{r datapasta-SmallBobRoss, eval=FALSE}
# datapasta::tribble_paste(fivethirtyeight::bob_ross %>%
#   dplyr::select(title, bushes, clouds) %>% 
#   utils::head(5))
```

```{r create-SmallBobRoss}
SmallBobRoss  <- tibble::tribble(~title, ~bushes, ~clouds,
                  "A WALK IN THE WOODS",      1L,      0L,
                         "MT. MCKINLEY",      0L,      1L,
                         "EBONY SUNSET",      0L,      0L,
                          "WINTER MIST",      1L,      1L,
                         "QUIET STREAM",      0L,      0L)
```

# step 3 (read_csv)

```{r step3, echo=FALSE}
fs::dir_tree("format-shape-data", regex = "step3.md")
```

Step 3 shows us how to import data into the R environment.

```{r export-small-bob-ross}
# fs::dir_ls("data")
readr::write_csv(as.data.frame(SmallBobRoss), "data/SmallBobRoss.csv")
```

```{r import-small-bob-ross}
readr::read_csv(file = "https://bit.ly/small-bob-ross")
```

# step 4  (fivethirtyeight, glimpse)

```{r step4, echo=FALSE}
fs::dir_tree("format-shape-data", regex = "step4.md")
```

This step imports the full `bob_ross` dataset from the `fivethirtyeight` package. We load the data into R using `fivethirtyeight::bob_ross`.

```{r BobRoss}
BobRoss <- fivethirtyeight::bob_ross
glimpse(BobRoss)
```

# step 5 (pivot_)

This section covers the `pivot_longer` function. 

```{r pivot_longer}
BobRossLong <- tidyr::pivot_longer(data = BobRoss, 
                      cols = c(apple_frame:wood_framed), 
                      names_to = 'object', 
                      values_to = 'present')

head(BobRossLong)
```

# step6

This section covers the `pivot_wider()` function. 

```{r pivot_wider}
BobRossWide <- tidyr::pivot_wider(data = BobRossLong, 
                      names_from = object, 
                      values_from = present)
head(BobRossWide)
```

Check with `setdiff`

```{r setdiff}
dplyr::setdiff(x = BobRoss, y = BobRossWide)
```


## Appendix 1: Katacoda scenario tutorials

The tutorial for building the scenario is [here](https://katacoda.com/scenario-examples/scenarios/create-scenario-101).

I took notes on this tutorial and made them available in [this Google document](https://docs.google.com/document/d/e/2PACX-1vSf2w2onhH5t3IhuD4sYLoWqn46BLKMYFR7q3BHO8QTaRkVgXfhKvnl8T9uHrjmbVpTZVKCWrfxEl0R/pub).

## Appendix 2: Katacoda guidelines

There are multiple guidelines and resources for writing scenarios. O'Reilly has provided an *Authoring Guide* and *Formatting and Design Guide*.

The link for these files can be found here:

+ [Katacoda Scenario Formatting and Design Guide for Authors](https://docs.google.com/document/d/1l4lofG5kAu8JFzumZPCsJJE2muCYe6rHSHCQsMlijd8/edit)

+ [Katacoda Scenario Authoring Guide](https://docs.google.com/document/d/14rudtruZQhRxvD3zcR3g75j5nuOgKGz4CYk8hdhaV-w/edit)

## Appendix 3: Scenario Checklist

**Scenario Readiness Checklist:**

When you think your scenario is ready for publication, we recommend you run through the checklist below to ensure it is ready to go. [Reminder: We discuss these best practices in the Katacoda Formatting and Design Guide for Authors]:

Does the scenario start consistently and in a timely manner? More than 5 minutes to start would be cause to reconsider your build decisions.

- [ ] Are your intro and final pages present and are their respective goals and lessons learned in agreement?

- [ ] Have you tested your scenario lately?

- [ ] Do you agree with the leveling (beginner, intermediate, advanced) you indicated when you started the build?

- [ ] Was learning time you entered correct, or should it be adjusted?

- [ ] Are your versions of tools and other dependencies up to date?

- [ ] Have you tried every instruction?

- [ ] Have you written each step in the most concise manner possible?

- [ ] Have you run your text through a spelling/grammar checker?

- [ ] Are your credits to others given present and correct?

- [ ] Are your images legal and with credits?

- [ ] Are your hyperlinks all working?

- [ ] Do the goals and lessons learned items match the steps in the scenario?


## Scenario contents

This scenario covers...
